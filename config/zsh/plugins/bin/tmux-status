#!/usr/bin/env zsh

# @TODO: This doesn't work with multiple tabs so this needs to be fixed up.

local tmux_pane=$(print "$1" | tr -d %)

print_tmux_var() {
    printenv "TMUX_$1_${tmux_pane}"
}

local default='#[fg=default]'
local cyan='#[fg=cyan]'
local yellow='#[fg=yellow]'
local blue='#[fg=blue]'
local black='#[fg=black]'
local magenta='#[fg=magenta]'
local white='#[fg=white]'

local drush_site=$(print_tmux_var DRUSH_SITE)
local date="$(date "+%a %m$white/$cyan%d %H$white:$cyan%M$white:$cyan%S")"


if [[ -n $drush_site ]]; then
    drush_site=${drush_site//@/$white@$cyan}
fi

if [[ -n $date ]]; then
    date="$cyan$date$default"
fi

local tmux_export=(
    $drush_site
    $date
)

print $output " $default${(j:  #[fg=default]|#[fg=default]  :)tmux_export}"
