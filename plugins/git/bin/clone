#!/usr/bin/env zsh
emulate -L zsh

local repo reponame type='unknown' shallow=0 print=0

while getopts dsp opt; do
    case $opt in
        (d)
            type='drupal'
        ;;
        (s)
            shallow=1
        ;;
        (p)
            print=1
        ;;
    esac
done
shift $(( OPTIND - 1 ))

reponame=$1
repo=$reponame

# Drupal Module
if [[ $type == 'drupal' ]]; then
   repo="https://git.drupal.org/project/$repo.git"
fi

local cloneopts=(-u -p)

if (( $shallow )); then
  cloneopts+=(--shallow)
fi

ghq get $cloneopts $repo

if (( $print )); then
    ghq list -p $reponame
else
    ghq look $reponame
fi

