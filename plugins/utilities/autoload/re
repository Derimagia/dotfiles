local command=()
local clearcache=false
local restarttmux=false

while (( $# > 0 )); do
    case "$1" in
        -t)
            restarttmux=true
        ;;
        -c)
            clearcache=true
        ;;
        *)
            command+=("$1")
        ;;
    esac
    shift
done

if $clearcache; then
    zplug clear
    zplug clean --force
    zplug check || zplug install
    print -l "Cleared Caches"
fi

if $restarttmux && [[ -n $TMUX ]] ; then
    # Doesn't work since it kills this session...
    { tmux kill-server  && tmuxx && print -l "Restarted Tmux" }&!
fi

if [[ -n $command ]]; then
    zsh -ic "$command; exit"
else
    print -l "Re-sourced .zshrc"
    source $HOME/.zshrc
fi
